<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Organizer Dashboard</title>
  
  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
    body{
      background:#1a1a1a url('https://www.transparenttextures.com/patterns/dark-denim-3.png');
      color:#f0f0f0;min-height:100vh;display:flex;justify-content:center;align-items:center;padding:2rem;
    }
    .dashboard-container{width:100%;max-width:1200px;display:flex;flex-direction:column;gap:2rem;}

    /* Header */
    .dashboard-header{display:flex;align-items:center;justify-content:space-between;}
    .dashboard-header-left{display:flex;align-items:center;gap:1rem;}
    .shield-icon{font-size:2.5rem;}
    .logout-btn{background:#e53935;border:none;padding:.6rem 1.2rem;border-radius:6px;color:#fff;font-weight:600;cursor:pointer;}
    .logout-btn:hover{background:#c62828;}

    /* Main layout */
    .dashboard-main{display:flex;gap:2rem;width:100%;}
    @media(max-width:992px){.dashboard-main{flex-direction:column;}}

    /* Form section */
    .form-section{flex:1;background:#a32424;padding:1.5rem;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,.3);}
    .form-section h2{margin-bottom:1rem;font-weight:600;}
    .event-form .form-group{margin-bottom:1rem;}
    .event-form label{display:block;margin-bottom:.5rem;}
    .event-form input,.event-form textarea{
      width:100%;padding:.75rem;border:1px solid rgba(255,255,255,.3);
      border-radius:6px;background:rgba(0,0,0,.2);color:#fff;
    }
    .save-button{width:100%;padding:.8rem;background:#e53935;border:none;border-radius:6px;color:#fff;font-weight:600;cursor:pointer;}
    .save-button:hover{background:#c62828;}

    /* List section */
    .list-section{flex:1;background:#fff;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,.3);display:flex;flex-direction:column;}
    .list-header{background:#e11d48;color:#fff;padding:1rem 1.5rem;display:flex;align-items:center;gap:.75rem;}
    .event-list{padding:1rem;flex:1;overflow-y:auto;display:flex;flex-direction:column;gap:1rem;}
    .event-card{background:#f9fafb;border:1px solid #e5e7eb;border-radius:8px;padding:1rem;display:flex;justify-content:space-between;align-items:flex-start;}
    
    /* Event details */
    .event-details h3{margin-bottom:.25rem; color:black;} /* Only event titles black */
    .event-details p{color:#6b7280;margin-bottom:.5rem;}
    .event-meta{display:flex;gap:1rem;font-size:.85rem;color:#4b5563;}
    
    /* Event actions */
    .event-actions{display:flex;gap:1rem;font-size:1.1rem;color:#6b7280;}
    .event-actions i{cursor:pointer;transition:.3s;}
    .event-actions i:hover{color:#e11d48;}
  </style>
</head>
<body>
  <div class="dashboard-container">
    <header class="dashboard-header">
      <div class="dashboard-header-left">
        <i class="fa-solid fa-shield-halved shield-icon"></i>
        <h1>Momentus Organizer Dashboard</h1>
      </div>
      <button class="logout-btn" onclick="window.location.href='index.html'">Logout</button>
    </header>

    <main class="dashboard-main">
      <!-- Left Form -->
      <section class="form-section">
        <h2><i class="fa-solid fa-plus"></i> Add New Event</h2>
        <form class="event-form" id="eventForm">
          <input type="hidden" id="eventId">
          <div class="form-group">
            <label>Event Title</label>
            <input type="text" id="event-title" required>
          </div>
          <div class="form-group">
            <label>Description</label>
            <textarea id="event-description" required></textarea>
          </div>
          <div class="form-group">
            <label>Amount</label>
            <input type="number" id="event-amount" required>
          </div>
          <div class="form-group">
            <label>Date</label>
            <input type="date" id="event-date" required>
          </div>
          <div class="form-group">
            <label>Location</label>
            <input type="text" id="event-location" required>
          </div>
          <button type="submit" class="save-button">
            <i class="fa-solid fa-floppy-disk"></i> <span id="button-text">Save Event</span>
          </button>
        </form>
      </section>

      <!-- Right Event List -->
      <section class="list-section">
        <div class="list-header">
          <i class="fa-solid fa-bars"></i><h2>Manage Events</h2>
        </div>
        <div class="event-list" id="eventList"></div>
      </section>
    </main>
  </div>

<script>
  const eventForm=document.getElementById("eventForm");
  const eventList=document.getElementById("eventList");
  const formButtonText=document.getElementById("button-text");

  async function fetchEvents(){
    try{
      const res=await fetch("OrganizerServlet",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=list"});
      const events=await res.json();
      renderEvents(events);
    }catch(err){
      console.error("Fetch error:",err);
//      renderEvents([{id:1,title:"Hackathon",description:"Tech event",amount:200,date:"2025-09-01",location:"Auditorium"}]);
    }
  }

  function renderEvents(events){
    eventList.innerHTML="";
    events.forEach(ev=>{
      const div=document.createElement("div");
      div.className="event-card";
      div.innerHTML=`
        <div class="event-details">
          <h3>${ev.title}</h3>
          <p>${ev.description}</p>
          <div class="event-meta">
            <span><i class="fa-solid fa-calendar-days"></i> ${ev.date}</span>
            <span><i class="fa-solid fa-location-dot"></i> ${ev.location}</span>
            <span><i class="fa-solid fa-money-bill"></i> â‚¹${ev.amount}</span>
          </div>
        </div>
        <div class="event-actions">
          <i class="fa-solid fa-pen-to-square" onclick="editEvent(${ev.id},'${ev.title}','${ev.description}','${ev.amount}','${ev.date}','${ev.location}')"></i>
          <i class="fa-solid fa-trash-can" onclick="deleteEvent(${ev.id})"></i>
        </div>`;
      eventList.appendChild(div);
    });
  }

  eventForm.addEventListener("submit",async e=>{
    e.preventDefault();
    const id=document.getElementById("eventId").value;
    const action=id?"update":"add";
    const data=new URLSearchParams();
    if(id) data.append("id",id);
    data.append("action",action);
    data.append("title",document.getElementById("event-title").value);
    data.append("description",document.getElementById("event-description").value);
    data.append("amount",document.getElementById("event-amount").value);
    data.append("date",document.getElementById("event-date").value);
    data.append("location",document.getElementById("event-location").value);

    await fetch("OrganizerServlet",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:data.toString()});
    eventForm.reset();
    document.getElementById("eventId").value="";
    formButtonText.textContent="Save Event";
    fetchEvents();
  });

  function editEvent(id,title,desc,amount,date,location){
    document.getElementById("eventId").value=id;
    document.getElementById("event-title").value=title;
    document.getElementById("event-description").value=desc;
    document.getElementById("event-amount").value=amount;
    document.getElementById("event-date").value=date;
    document.getElementById("event-location").value=location;
    formButtonText.textContent="Update Event";
  }

  async function deleteEvent(id){
    await fetch("OrganizerServlet",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=delete&id="+id});
    fetchEvents();
  }

  fetchEvents();
</script>
</body>
</html>
